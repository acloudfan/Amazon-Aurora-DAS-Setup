{"changed":true,"filter":false,"title":"sqlevents_processor.py","tooltip":"/code/processor/sqlevents_processor.py","value":"import json\nimport base64\n\nclass SQLEventRecords():\n    records = []\n    # Initialize\n    def __init__(self):\n        print('SQLEventRecords')\n        \n    def add(self,recordId, record, approximateArrivalTimestamp):\n        self.records.append((recordId, record, approximateArrivalTimestamp))\n    \n    # Returns an array of processed heartbeat records\n    def process(self):\n        print('HB processing count = %'.format(len(self.records)))\n        output_records = []\n        \n        \n        \n        for record in self.records:\n            # convert JSON to string\n            record_send = json.dumps(record[1])\n            \n            record_send= record_send + '\\n'\n            \n            # No change to the record\n            output_record = {\n                'recordId': record[0],\n                'result': 'Ok',\n                'data': base64.b64encode(record_send.encode()).decode(\"ascii\")\n            }\n            output_records.append(output_record)\n        \n        return output_records","undoManager":{"mark":-2,"position":0,"stack":[[{"start":{"row":0,"column":0},"end":{"row":33,"column":29},"action":"insert","lines":["import json","import base64","","class SQLEventRecords():","    records = []","    # Initialize","    def __init__(self):","        print('SQLEventRecords')","        ","    def add(self,recordId, record, approximateArrivalTimestamp):","        self.records.append((recordId, record, approximateArrivalTimestamp))","    ","    # Returns an array of processed heartbeat records","    def process(self):","        print('HB processing count = %'.format(len(self.records)))","        output_records = []","        ","        ","        ","        for record in self.records:","            # convert JSON to string","            record_send = json.dumps(record[1])","            ","            record_send= record_send + '\\n'","            ","            # No change to the record","            output_record = {","                'recordId': record[0],","                'result': 'Ok',","                'data': base64.b64encode(record_send.encode()).decode(\"ascii\")","            }","            output_records.append(output_record)","        ","        return output_records"],"id":1}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":33,"column":29},"end":{"row":33,"column":29},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":95,"mode":"ace/mode/python"}},"timestamp":1618138275701}